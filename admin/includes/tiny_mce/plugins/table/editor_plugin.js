(function(a){var d=a.each;function c(f,g){var h=g.ownerDocument,e=h.createRange(),j;e.setStartBefore(g);e.setEnd(f.endContainer,f.endOffset);j=h.createElement("body");j.appendChild(e.cloneContents());return j.innerHTML.replace(/<(br|img|object|embed|input|textarea)[^>]*>/gi,"-").replace(/<[^>]+>/g,"").length==0}function b(F,D,u){var e,K,E,m;g();m=D.getParent(u.getStart(),"th,td");if(m){K=C(m);E=z();m=J(K.x,K.y)}function I(M,L){M=M.cloneNode(L);M.removeAttribute("id");return M}function g(){var L=0;e=[];d(["thead","tbody","tfoot"],function(M){var N=D.select("> "+M+" tr",F);d(N,function(O,P){P+=L;d(D.select("> td, > th",O),function(V,Q){var R,S,T,U;if(e[P]){while(e[P][Q]){Q++}}T=q(V,"rowspan");U=q(V,"colspan");for(S=P;S<P+T;S++){if(!e[S]){e[S]=[]}for(R=Q;R<Q+U;R++){e[S][R]={part:M,real:S==P&&R==Q,elm:V,rowspan:T,colspan:U}}}})});L+=N.length})}function J(L,N){var M;M=e[N];if(M){return M[L]}}function q(M,L){return parseInt(M.getAttribute(L)||1)}function f(L){return D.hasClass(L.elm,"mceSelected")||L==m}function p(){var L=[];d(F.rows,function(M){d(M.cells,function(N){if(D.hasClass(N,"mceSelected")||N==m.elm){L.push(M);return false}})});return L}function h(){var L=D.createRng();L.setStartAfter(F);L.setEndAfter(F);u.setRng(L);D.remove(F)}function t(L){var M;a.walk(L,function(O){var N;if(O.nodeType==3){d(D.getParents(O.parentNode,null,L).reverse(),function(P){P=I(P,false);if(!M){M=N=P}else{if(N){N.appendChild(P)}}N=P});if(N){N.innerHTML=a.isIE?"&nbsp;":'<br _mce_bogus="1" />'}return false}},"childNodes");L=I(L,false);L.rowSpan=L.colSpan=1;if(M){L.appendChild(M)}else{if(!a.isIE){L.innerHTML='<br _mce_bogus="1" />'}}return L}function n(){var L=D.createRng();d(D.select("tr",F),function(M){if(M.cells.length==0){D.remove(M)}});if(D.select("tr",F).length==0){L.setStartAfter(F);L.setEndAfter(F);u.setRng(L);D.remove(F);return}d(D.select("thead,tbody,tfoot",F),function(M){if(M.rows.length==0){D.remove(M)}});g();row=e[Math.min(e.length-1,K.y)];if(row){u.select(row[Math.min(row.length-1,K.x)].elm,true);u.collapse(true)}}function s(R,Q,T,P){var N,M,L,O,S;N=e[Q][R].elm.parentNode;for(L=1;L<=T;L++){N=D.getNext(N,"tr");if(N){for(M=R;M>=0;M--){S=e[Q+L][M].elm;if(S.parentNode==N){for(O=1;O<=P;O++){D.insertAfter(t(S),S)}break}}if(M==-1){for(O=1;O<=P;O++){N.insertBefore(t(N.cells[0]),N.cells[0])}}}}}function w(){d(e,function(L,M){d(L,function(O,N){var R,Q,S,P;if(f(O)){O=O.elm;R=q(O,"colspan");Q=q(O,"rowspan");if(R>1||Q>1){O.colSpan=O.rowSpan=1;for(P=0;P<R-1;P++){D.insertAfter(t(O),O)}s(N,M,Q-1,R)}}})})}function l(S,Q,W){var M,N,V,T,R,P,U,O,S,L;if(S){pos=C(S);M=pos.x;N=pos.y;V=M+(Q-1);T=N+(W-1)}else{M=K.x;N=K.y;V=E.x;T=E.y}U=J(M,N);O=J(V,T);if(U&&O&&U.part==O.part){w();g();U=J(M,N).elm;U.colSpan=(V-M)+1;U.rowSpan=(T-N)+1;for(P=N;P<=T;P++){for(R=M;R<=V;R++){S=e[P][R].elm;if(S!=U){L=a.grep(S.childNodes);d(L,function(Y,X){if(Y.nodeName!="BR"||X!=L.length-1){U.appendChild(Y)}});D.remove(S)}}}n()}}function o(T){var M,S,L,P,Q,R,N,O;d(e,function(U,V){d(U,function(X,W){if(f(X)){X=X.elm;Q=X.parentNode;R=I(Q,false);M=V;if(T){return false}}});if(T){return !M}});for(P=0;P<e[0].length;P++){S=e[M][P].elm;if(S!=L){if(!T){rowSpan=q(S,"rowspan");if(rowSpan>1){S.rowSpan=rowSpan+1;continue}}else{if(M>0&&e[M-1][P]){O=e[M-1][P].elm;rowSpan=q(O,"rowspan");if(rowSpan>1){O.rowSpan=rowSpan+1;continue}}}N=t(S);N.colSpan=S.colSpan;R.appendChild(N);L=S}}if(R.hasChildNodes()){if(!T){D.insertAfter(R,Q)}else{Q.parentNode.insertBefore(R,Q)}}}function r(L){var N,M;d(e,function(O,P){d(O,function(R,Q){if(f(R)){N=Q;if(L){return false}}});if(L){return !N}});d(e,function(R,S){var O=R[N].elm,P,Q;if(O!=M){Q=q(O,"colspan");P=q(O,"rowspan");if(Q==1){if(!L){D.insertAfter(t(O),O);s(N,S,P-1,Q)}else{O.parentNode.insertBefore(t(O),O);s(N,S,P-1,Q)}}else{O.colSpan++}M=O}})}function k(){var L=[];d(e,function(M,N){d(M,function(P,O){if(f(P)&&a.inArray(L,O)===-1){d(e,function(S){var Q=S[O].elm,R;R=q(Q,"colspan");if(R>1){Q.colSpan=R-1}else{D.remove(Q)}});L.push(O)}})});n()}function j(){var M;function L(P){var N,Q,O;N=D.getNext(P,"tr");d(P.cells,function(R){var S=q(R,"rowspan");if(S>1){R.rowSpan=S-1;Q=C(R);s(Q.x,Q.y,1,1)}});Q=C(P.cells[0]);d(e[Q.y],function(R){var S;R=R.elm;if(R!=O){S=q(R,"rowspan");if(S<=1){D.remove(R)}else{R.rowSpan=S-1}O=R}})}M=p();d(M.reverse(),function(N){L(N)});n()}function B(){var L=p();D.remove(L);n();return L}function A(){var L=p();d(L,function(N,M){L[M]=I(N,true)});return L}function G(N,L){var P=p(),M=P[L?0:P.length-1],O=M.cells.length;d(e,function(R){var Q;O=0;d(R,function(T,S){if(T.real){O+=T.colspan}if(T.elm.parentNode==M){Q=1}});if(Q){return false}});if(!L){N.reverse()}d(N,function(S){var R=S.cells.length,Q;for(i=0;i<R;i++){Q=S.cells[i];Q.colSpan=Q.rowSpan=1}for(i=R;i<O;i++){S.appendChild(t(S.cells[R-1]))}for(i=O;i<R;i++){D.remove(S.cells[i])}if(L){M.parentNode.insertBefore(S,M)}else{D.insertAfter(S,M)}})}function C(M){var L;d(e,function(N,O){d(N,function(Q,P){if(Q.elm==M){L={x:P,y:O};return false}});return !L});return L}function H(L){K=C(L)}function z(){var N,M,L;M=L=0;d(e,function(O,P){d(O,function(R,Q){var T,S;if(f(R)){R=e[P][Q];if(Q>M){M=Q}if(P>L){L=P}if(R.real){T=R.colspan-1;S=R.rowspan-1;if(T){if(Q+T>M){M=Q+T}}if(S){if(P+S>L){L=P+S}}}}})});return{x:M,y:L}}function v(R){var N,O,T,S,M,L,P,Q;E=C(R);if(K&&E){N=Math.min(K.x,E.x);O=Math.min(K.y,E.y);T=Math.max(K.x,E.x);S=Math.max(K.y,E.y);M=T;L=S;for(y=O;y<=L;y++){R=e[y][N];if(!R.real){if(N-(R.colspan-1)<N){N-=R.colspan-1}}}for(x=N;x<=M;x++){R=e[O][x];if(!R.real){if(O-(R.rowspan-1)<O){O-=R.rowspan-1}}}for(y=O;y<=S;y++){for(x=N;x<=T;x++){R=e[y][x];if(R.real){P=R.colspan-1;Q=R.rowspan-1;if(P){if(x+P>M){M=x+P}}if(Q){if(y+Q>L){L=y+Q}}}}}D.removeClass(D.select("td.mceSelected,th.mceSelected"),"mceSelected");for(y=O;y<=L;y++){for(x=N;x<=M;x++){D.addClass(e[y][x].elm,"mceSelected")}}}}a.extend(this,{deleteTable:h,split:w,merge:l,insertRow:o,insertCol:r,deleteCols:k,deleteRows:j,cutRows:B,copyRows:A,pasteRows:G,getPos:C,setStartCell:H,setEndCell:v})}a.create("tinymce.plugins.TablePlugin",{init:function(e,f){var h,k;function j(n){var l=e.selection,m=e.dom.getParent(n||l.getNode(),"table");if(m){return new b(m,e.dom,l)}}function g(){e.getBody().style.webkitUserSelect="";e.dom.removeClass(e.dom.select("td.mceSelected,th.mceSelected"),"mceSelected")}d([["table","table.desc","mceInsertTable",true],["delete_table","table.del","mceTableDelete"],["delete_col","table.delete_col_desc","mceTableDeleteCol"],["delete_row","table.delete_row_desc","mceTableDeleteRow"],["col_after","table.col_after_desc","mceTableInsertColAfter"],["col_before","table.col_before_desc","mceTableInsertColBefore"],["row_after","table.row_after_desc","mceTableInsertRowAfter"],["row_before","table.row_before_desc","mceTableInsertRowBefore"],["row_props","table.row_desc","mceTableRowProps",true],["cell_props","table.cell_desc","mceTableCellProps",true],["split_cells","table.split_cells_desc","mceTableSplitCells",true],["merge_cells","table.merge_cells_desc","mceTableMergeCells",true]],function(l){e.addButton(l[0],{title:l[1],cmd:l[2],ui:l[3]})});if(!a.isIE){e.onClick.add(function(l,m){m=m.target;if(m.nodeName==="TABLE"){l.selection.select(m)}})}e.onNodeChange.add(function(m,l,q){var o;q=m.selection.getStart();o=m.dom.getParent(q,"td,th,caption");l.setActive("table",q.nodeName==="TABLE"||!!o);if(o&&o.nodeName==="CAPTION"){o=0}l.setDisabled("delete_table",!o);l.setDisabled("delete_col",!o);l.setDisabled("delete_table",!o);l.setDisabled("delete_row",!o);l.setDisabled("col_after",!o);l.setDisabled("col_before",!o);l.setDisabled("row_after",!o);l.setDisabled("row_before",!o);l.setDisabled("row_props",!o);l.setDisabled("cell_props",!o);l.setDisabled("split_cells",!o);l.setDisabled("merge_cells",!o)});e.onInit.add(function(l){var o,q,p=l.dom,n;h=l.windowManager;l.onMouseDown.add(function(r,s){if(s.button!=2){g();q=p.getParent(s.target,"td,th");o=p.getParent(q,"table")}});p.bind(l.getDoc(),"mouseover",function(t){var s,r,u=t.target;if(q&&(n||u!=q)&&(u.nodeName=="TD"||u.nodeName=="TH")){r=p.getParent(u,"table");if(r==o){if(!n){n=j(r);n.setStartCell(q);l.getBody().style.webkitUserSelect="none"}n.setEndCell(u)}s=l.selection.getSel();if(s.removeAllRanges){s.removeAllRanges()}else{s.empty()}t.preventDefault()}});l.onMouseUp.add(function(w,z){var r,s=w.selection,B,D=s.getSel(),C,u,A,t;if(q){if(n){w.getBody().style.webkitUserSelect=""}function v(E,G){var F=new a.dom.TreeWalker(E,E);do{if(E.nodeType==3&&a.trim(E.nodeValue).length!=0){if(G){r.setStart(E,0)}else{r.setEnd(E,E.nodeValue.length)}return}if(E.nodeName=="BR"){if(G){r.setStartBefore(E)}else{r.setEndBefore(E)}return}}while(E=(G?F.next():F.prev()))}B=p.select("td.mceSelected,th.mceSelected");if(B.length>0){r=p.createRng();u=B[0];t=B[B.length-1];v(u,1);C=new a.dom.TreeWalker(u,p.getParent(B[0],"table"));do{if(u.nodeName=="TD"||u.nodeName=="TH"){if(!p.hasClass(u,"mceSelected")){break}A=u}}while(u=C.next());v(A);s.setRng(r)}w.nodeChanged();q=n=o=null}});l.onKeyUp.add(function(r,s){g()});if(l&&l.plugins.contextmenu){l.plugins.contextmenu.onContextMenu.add(function(t,r,v){var w,u=l.selection,s=u.getNode()||l.getBody();if(l.dom.getParent(v,"td")||l.dom.getParent(v,"th")||l.dom.select("td.mceSelected,th.mceSelected").length){r.removeAll();if(s.nodeName=="A"&&!l.dom.getAttrib(s,"name")){r.add({title:"advanced.link_desc",icon:"link",cmd:l.plugins.advlink?"mceAdvLink":"mceLink",ui:true});r.add({title:"advanced.unlink_desc",icon:"unlink",cmd:"UnLink"});r.addSeparator()}if(s.nodeName=="IMG"&&s.className.indexOf("mceItem")==-1){r.add({title:"advanced.image_desc",icon:"image",cmd:l.plugins.advimage?"mceAdvImage":"mceImage",ui:true});r.addSeparator()}r.add({title:"table.desc",icon:"table",cmd:"mceInsertTable",value:{action:"insert"}});r.add({title:"table.props_desc",icon:"table_props",cmd:"mceInsertTable"});r.add({title:"table.del",icon:"delete_table",cmd:"mceTableDelete"});r.addSeparator();w=r.addMenu({title:"table.cell"});w.add({title:"table.cell_desc",icon:"cell_props",cmd:"mceTableCellProps"});w.add({title:"table.split_cells_desc",icon:"split_cells",cmd:"mceTableSplitCells"});w.add({title:"table.merge_cells_desc",icon:"merge_cells",cmd:"mceTableMergeCells"});w=r.addMenu({title:"table.row"});w.add({title:"table.row_desc",icon:"row_props",cmd:"mceTableRowProps"});w.add({title:"table.row_before_desc",icon:"row_before",cmd:"mceTableInsertRowBefore"});w.add({title:"table.row_after_desc",icon:"row_after",cmd:"mceTableInsertRowAfter"});w.add({title:"table.delete_row_desc",icon:"delete_row",cmd:"mceTableDeleteRow"});w.addSeparator();w.add({title:"table.cut_row_desc",icon:"cut",cmd:"mceTableCutRow"});w.add({title:"table.copy_row_desc",icon:"copy",cmd:"mceTableCopyRow"});w.add({title:"table.paste_row_before_desc",icon:"paste",cmd:"mceTablePasteRowBefore"}).setDisabled(!k);w.add({title:"table.paste_row_after_desc",icon:"paste",cmd:"mceTablePasteRowAfter"}).setDisabled(!k);w=r.addMenu({title:"table.col"});w.add({title:"table.col_before_desc",icon:"col_before",cmd:"mceTableInsertColBefore"});w.add({title:"table.col_after_desc",icon:"col_after",cmd:"mceTableInsertColAfter"});w.add({title:"table.delete_col_desc",icon:"delete_col",cmd:"mceTableDeleteCol"})}else{r.add({title:"table.desc",icon:"table",cmd:"mceInsertTable"})}})}if(!a.isIE){function m(){var r;for(r=l.getBody().lastChild;r&&r.nodeType==3&&!r.nodeValue.length;r=r.previousSibling){}if(r&&r.nodeName=="TABLE"){l.dom.add(l.getBody(),"p",null,'<br mce_bogus="1" />')}}if(a.isGecko){l.onKeyDown.add(function(s,u){var r,t,v=s.dom;if(u.keyCode==37||u.keyCode==38){r=s.selection.getRng();t=v.getParent(r.startContainer,"table");if(t&&s.getBody().firstChild==t){if(c(r,t)){r=v.createRng();r.setStartBefore(t);r.setEndBefore(t);s.selection.setRng(r);u.preventDefault()}}}})}l.onKeyUp.add(m);l.onSetContent.add(m);l.onVisualAid.add(m);l.onPreProcess.add(function(r,t){var s=t.node.lastChild;if(s&&s.childNodes.length==1&&s.firstChild.nodeName=="BR"){r.dom.remove(s)}});m()}});d({mceTableSplitCells:function(l){l.split()},mceTableMergeCells:function(m){var n,o,l;l=e.dom.getParent(e.selection.getNode(),"th,td");if(l){n=l.rowSpan;o=l.colSpan}if(!e.dom.select("td.mceSelected,th.mceSelected").length){h.open({url:f+"/merge_cells.htm",width:240+parseInt(e.getLang("table.merge_cells_delta_width",0)),height:110+parseInt(e.getLang("table.merge_cells_delta_height",0)),inline:1},{rows:n,cols:o,onaction:function(p){m.merge(l,p.cols,p.rows)},plugin_url:f})}else{m.merge()}},mceTableInsertRowBefore:function(l){l.insertRow(true)},mceTableInsertRowAfter:function(l){l.insertRow()},mceTableInsertColBefore:function(l){l.insertCol(true)},mceTableInsertColAfter:function(l){l.insertCol()},mceTableDeleteCol:function(l){l.deleteCols()},mceTableDeleteRow:function(l){l.deleteRows()},mceTableCutRow:function(l){k=l.cutRows()},mceTableCopyRow:function(l){k=l.copyRows()},mceTablePasteRowBefore:function(l){l.pasteRows(k,true)},mceTablePasteRowAfter:function(l){l.pasteRows(k)},mceTableDelete:function(l){l.deleteTable()}},function(m,l){e.addCommand(l,function(){var n=j();if(n){m(n);e.execCommand("mceRepaint");g()}})});d({mceInsertTable:function(l){h.open({url:f+"/table.htm",width:400+parseInt(e.getLang("table.table_delta_width",0)),height:320+parseInt(e.getLang("table.table_delta_height",0)),inline:1},{plugin_url:f,action:l?l.action:0})},mceTableRowProps:function(){h.open({url:f+"/row.htm",width:400+parseInt(e.getLang("table.rowprops_delta_width",0)),height:295+parseInt(e.getLang("table.rowprops_delta_height",0)),inline:1},{plugin_url:f})},mceTableCellProps:function(){h.open({url:f+"/cell.htm",width:400+parseInt(e.getLang("table.cellprops_delta_width",0)),height:295+parseInt(e.getLang("table.cellprops_delta_height",0)),inline:1},{plugin_url:f})}},function(m,l){e.addCommand(l,function(n,o){m(o)})})}});a.PluginManager.add("table",a.plugins.TablePlugin)})(tinymce);