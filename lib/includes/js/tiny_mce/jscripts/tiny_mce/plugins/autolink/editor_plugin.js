(function(){tinymce.create("tinymce.plugins.AutolinkPlugin",{init:function(a,b){var c=this;if(tinyMCE.isIE){return}a.onKeyDown.add(function(d,f){if(f.keyCode==13){return c.handleEnter(d)}if(f.shiftKey&&f.keyCode==48){return c.handleEclipse(d)}});a.onKeyUp.add(function(d,f){if(f.keyCode==32){return c.handleSpacebar(d)}})},handleEclipse:function(a){this.parseCurrentLine(a,-1,"(",true)},handleSpacebar:function(a){this.parseCurrentLine(a,0,"",true)},handleEnter:function(a){this.parseCurrentLine(a,-1,"",false)},parseCurrentLine:function(h,c,k,f){var a,e,b,m,j,n,g,d,i;a=h.selection.getRng().cloneRange();if(a.startOffset<5){d=a.endContainer.previousSibling;if(d==null){if(a.endContainer.firstChild==null||a.endContainer.firstChild.nextSibling==null){return}d=a.endContainer.firstChild.nextSibling}i=d.length;a.setStart(d,i);a.setEnd(d,i);if(a.endOffset<5){return}e=a.endOffset;m=d}else{m=a.endContainer;if(m.nodeType!=3&&m.firstChild){while(m.nodeType!=3&&m.firstChild){m=m.firstChild}a.setStart(m,0);a.setEnd(m,m.nodeValue.length)}if(a.endOffset==1){e=2}else{e=a.endOffset-1-c}}b=e;do{a.setStart(m,e-2);a.setEnd(m,e-1);e-=1}while(a.toString()!=" "&&a.toString()!=""&&a.toString().charCodeAt(0)!=160&&(e-2)>=0&&a.toString()!=k);if(a.toString()==k||a.toString().charCodeAt(0)==160){a.setStart(m,e);a.setEnd(m,b);e+=1}else{if(a.startOffset==0){a.setStart(m,0);a.setEnd(m,b)}else{a.setStart(m,e);a.setEnd(m,b)}}n=a.toString();g=n.match(/^(https?:\/\/|ssh:\/\/|ftp:\/\/|file:\/|www\.)(.+)$/i);if(g){if(g[1]=="www."){g[1]="http://www."}j=h.selection.getBookmark();h.selection.setRng(a);tinyMCE.execCommand("mceInsertLink",false,g[1]+g[2]);h.selection.moveToBookmark(j);if(tinyMCE.isWebKit){h.selection.collapse(false);var l=Math.min(m.length,b+1);a.setStart(m,l);a.setEnd(m,l);h.selection.setRng(a)}}},getInfo:function(){return{longname:"Autolink plugin",author:"Ephox Corporation",authorurl:"http://tinymce.ephox.com",infourl:"http://tinymce.ephox.com",version:tinymce.majorVersion+"."+tinymce.minorVersion}}});tinymce.PluginManager.add("autolink",tinymce.plugins.AutolinkPlugin)})();